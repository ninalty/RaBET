Original code shared by Grey.
Code in .pyt format
